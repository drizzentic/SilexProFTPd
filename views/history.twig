{# history.twig #}
{% extends 'layout.twig' %}
{% block title %}History{% endblock %}
{% block content %}

  <div class="row">
    <div class="span16">
      <h2>
        History <small><b>{{ histories|length }} actions found
        {% if user is defined %}
          from user `<a href="{{ app.url_generator.generate('user_edit', { 'id': user.id }) }}">{{ user.username }}</a>`
        {% endif %}
        </b></small>
      </h2>
      <br/>

      <table id="sort-users" class="bordered-table zebra-striped">
        <thead>
          <tr>
            <th>Date</th>
            {% if user is not defined %}
              <th>Username</th>
            {% endif %}
            <th>Filename</th>
            <th>Transfertype</th>
            <th>Transfersize</th>
            <th>Transferhost</th>
            <th>Transfertime</th>
          </tr>
        </thead>
        <tbody>
        {% for history in histories %}
          <tr>
            <td>{{ history.transferdate }}</td>
            {% if user is not defined %}
              <td><a href="{{ app.url_generator.generate('user_edit', { 'id': history.user_id }) }}">{{ history.username }}</a></td>
            {% endif %}
            <td style="word-break: break-all;">
              {% if history.filename|length > 50%}
                {{ history.filename|trunk_tooltip|raw }}
              {% else %}
                {{ history.filename }}
              {% endif %}
            </td>
            <td>{{ history.transfertype }}</td>
            <td>{{ history.transfersize|byte2size }}</td>
            <td>{{ history.transferhost }}</td>
            <td>{{ history.transfertime|sec2hms }}</td>
          </tr>
        {% else %}
          <tr><td colspan="7">Still no history in the database</td></tr>
        {% endfor %}
        </tbody>
      </table>

    </div>
  </div>

  <script type="text/javascript" src="/assets/jquery.min.js"></script>
  <script type="text/javascript" src="/assets/bootstrap/js/bootstrap-twipsy.js"></script>
  <script type="text/javascript" src="/assets/bootstrap/js/bootstrap-popover.js"></script>
  <script type="text/javascript" src="/assets/jquery.tablesorter.min.js"></script>
  <script >
    $(function() {
      $("table#sort-users").tablesorter();
      $('.tooltip').popover();
    });
  </script>
{% endblock %}
